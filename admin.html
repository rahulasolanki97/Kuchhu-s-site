<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin - JSON File Generator</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .header {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        }

        h1 {
            color: #764ba2;
            margin-bottom: 10px;
        }

        .alert {
            background: #fff3cd;
            border: 1px solid #ffc107;
            padding: 15px;
            border-radius: 5px;
            margin-top: 10px;
        }

        .section {
            background: white;
            padding: 25px;
            border-radius: 10px;
            margin-bottom: 20px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        }

        h2 {
            color: #764ba2;
            margin-bottom: 20px;
            border-bottom: 2px solid #764ba2;
            padding-bottom: 10px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #333;
        }

        input[type="text"],
        input[type="number"],
        input[type="date"],
        input[type="file"],
        textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
            transition: border-color 0.3s;
        }

        input:focus,
        textarea:focus {
            outline: none;
            border-color: #764ba2;
        }

        textarea {
            min-height: 100px;
            resize: vertical;
        }

        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 12px 30px;
            border: none;
            border-radius: 5px;
            font-size: 16px;
            cursor: pointer;
            transition: transform 0.2s;
        }

        .btn:hover {
            transform: translateY(-2px);
        }

        .btn-secondary {
            background: #6c757d;
        }

        .btn-danger {
            background: #dc3545;
        }

        .product-item {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 15px;
            border-left: 4px solid #764ba2;
            display: flex;
            gap: 15px;
            align-items: flex-start;
        }

        .product-item img {
            width: 100px;
            height: 100px;
            object-fit: cover;
            border-radius: 5px;
            border: 2px solid #ddd;
        }

        .product-info {
            flex: 1;
        }

        .product-item h3 {
            color: #764ba2;
            margin-bottom: 10px;
        }

        .product-actions {
            margin-top: 10px;
            display: flex;
            gap: 10px;
        }

        .json-output {
            background: #2d2d2d;
            color: #f8f8f2;
            padding: 20px;
            border-radius: 5px;
            overflow-x: auto;
            margin-top: 20px;
            font-family: 'Courier New', monospace;
            white-space: pre-wrap;
            max-height: 400px;
            overflow-y: auto;
        }

        .copy-btn {
            margin-top: 10px;
        }

        .grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        @media (max-width: 768px) {
            .grid {
                grid-template-columns: 1fr;
            }
        }

        .success-message {
            background: #d4edda;
            color: #155724;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
            border: 1px solid #c3e6cb;
        }

        .image-preview {
            margin-top: 10px;
            max-width: 200px;
        }

        .image-preview img {
            width: 100%;
            border-radius: 5px;
            border: 2px solid #ddd;
        }

        .upload-area {
            border: 2px dashed #764ba2;
            padding: 20px;
            border-radius: 5px;
            text-align: center;
            cursor: pointer;
            transition: background 0.3s;
        }

        .upload-area:hover {
            background: #f8f9fa;
        }

        .upload-area.dragover {
            background: #e7f3ff;
            border-color: #667eea;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üß∂ Loom Lyric Admin - JSON Generator</h1>
            <div class="alert">
                <strong>üìù Instructions:</strong>
                <ol style="margin-top: 10px; margin-left: 20px;">
                    <li>Upload your logo and fill in website settings</li>
                    <li>Add products with images (images will be converted to base64)</li>
                    <li>Click "Generate JSON Files" button</li>
                    <li>Copy the generated JSON code</li>
                    <li>Create files in your GitHub repository as shown</li>
                    <li>Commit and push changes to GitHub</li>
                </ol>
            </div>
        </div>

        <!-- Settings Section -->
        <div class="section">
            <h2>‚öôÔ∏è Website Settings</h2>
            <div class="form-group">
                <label>Logo Image:</label>
                <div class="upload-area" onclick="document.getElementById('logoFile').click()">
                    <p>üì∑ Click or drag to upload logo</p>
                    <input type="file" id="logoFile" accept="image/*" style="display: none;" onchange="handleLogoUpload(this)">
                </div>
                <div id="logoPreview" class="image-preview"></div>
            </div>
            <div class="grid">
                <div class="form-group">
                    <label>WhatsApp Number:</label>
                    <input type="text" id="whatsapp" placeholder="1234567890">
                </div>
                <div class="form-group">
                    <label>Instagram ID:</label>
                    <input type="text" id="instagram" placeholder="@your_instagram">
                </div>
            </div>
        </div>

        <!-- Products Section -->
        <div class="section">
            <h2>üõçÔ∏è Products</h2>
            
            <div id="productsList"></div>

            <h3 style="margin-top: 30px; margin-bottom: 15px;">Add New Product</h3>
            <div class="form-group">
                <label>Product Name:</label>
                <input type="text" id="productName" placeholder="Crochet Keychain">
            </div>
            <div class="grid">
                <div class="form-group">
                    <label>Normal Price:</label>
                    <input type="number" id="normalPrice" placeholder="100">
                </div>
                <div class="form-group">
                    <label>Special Price (optional):</label>
                    <input type="number" id="specialPrice" placeholder="80">
                </div>
            </div>
            <div class="grid">
                <div class="form-group">
                    <label>Special Price Start:</label>
                    <input type="date" id="specialStart">
                </div>
                <div class="form-group">
                    <label>Special Price End:</label>
                    <input type="date" id="specialEnd">
                </div>
            </div>
            <div class="form-group">
                <label>Description:</label>
                <textarea id="description" placeholder="Product description..."></textarea>
            </div>
            <div class="form-group">
                <label>Product Image:</label>
                <div class="upload-area" onclick="document.getElementById('productFile').click()">
                    <p>üì∑ Click or drag to upload product image</p>
                    <input type="file" id="productFile" accept="image/*" style="display: none;" onchange="handleProductImageUpload(this)">
                </div>
                <div id="productImagePreview" class="image-preview"></div>
            </div>
            <button class="btn" onclick="addProduct()">‚ûï Add Product</button>
        </div>

        <!-- Generate Section -->
        <div class="section">
            <h2>üìÑ Generated JSON Files</h2>
            <button class="btn" onclick="generateJSON()">üîÑ Generate JSON Files</button>
            
            <div id="outputSection" style="display: none;">
                <div class="success-message">
                    ‚úÖ JSON files generated successfully! Follow the instructions below.
                </div>

                <h3 style="margin-top: 20px;">1. Create file: <code>data/settings.json</code></h3>
                <div class="json-output" id="settingsJSON"></div>
                <button class="btn copy-btn" onclick="copyToClipboard('settingsJSON')">üìã Copy settings.json</button>

                <h3 style="margin-top: 30px;">2. Create file: <code>data/products.json</code></h3>
                <div class="json-output" id="productsJSON"></div>
                <button class="btn copy-btn" onclick="copyToClipboard('productsJSON')">üìã Copy products.json</button>

                <div class="alert" style="margin-top: 30px;">
                    <strong>üöÄ Next Steps:</strong>
                    <ol style="margin-top: 10px; margin-left: 20px;">
                        <li>Go to your GitHub repository</li>
                        <li>Create a folder named <code>data</code></li>
                        <li>Create <code>settings.json</code> inside data folder and paste the first JSON</li>
                        <li>Create <code>products.json</code> inside data folder and paste the second JSON</li>
                        <li>Commit and push changes</li>
                        <li>Wait 2-3 minutes for GitHub Pages to update</li>
                        <li>Your website will automatically load the data!</li>
                    </ol>
                </div>
            </div>
        </div>
    </div>

    <script>
        let products = [];
        let logoBase64 = '';
        let currentProductImage = '';

        function handleLogoUpload(input) {
            const file = input.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    logoBase64 = e.target.result;
                    document.getElementById('logoPreview').innerHTML = `<img src="${logoBase64}" alt="Logo Preview">`;
                };
                reader.readAsDataURL(file);
            }
        }

        function handleProductImageUpload(input) {
            const file = input.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    currentProductImage = e.target.result;
                    document.getElementById('productImagePreview').innerHTML = `<img src="${currentProductImage}" alt="Product Preview">`;
                };
                reader.readAsDataURL(file);
            }
        }

        function addProduct() {
            const product = {
                id: Date.now(),
                name: document.getElementById('productName').value,
                normalPrice: parseFloat(document.getElementById('normalPrice').value) || 0,
                specialPrice: parseFloat(document.getElementById('specialPrice').value) || null,
                specialPriceStart: document.getElementById('specialStart').value || null,
                specialPriceEnd: document.getElementById('specialEnd').value || null,
                description: document.getElementById('description').value,
                image: currentProductImage
            };

            if (!product.name || !product.normalPrice || !product.image) {
                alert('Please fill in Product Name, Normal Price, and upload an Image');
                return;
            }

            products.push(product);
            displayProducts();
            clearProductForm();
        }

        function displayProducts() {
            const list = document.getElementById('productsList');
            if (products.length === 0) {
                list.innerHTML = '<p style="color: #999;">No products added yet.</p>';
                return;
            }

            list.innerHTML = products.map((product, index) => `
                <div class="product-item">
                    <img src="${product.image}" alt="${product.name}">
                    <div class="product-info">
                        <h3>${product.name}</h3>
                        <p><strong>Price:</strong> ‚Çπ${product.normalPrice} ${product.specialPrice ? `<span style="color: #dc3545;">(Special: ‚Çπ${product.specialPrice})</span>` : ''}</p>
                        <p><strong>Description:</strong> ${product.description}</p>
                        <div class="product-actions">
                            <button class="btn btn-danger" onclick="deleteProduct(${index})">üóëÔ∏è Delete</button>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function deleteProduct(index) {
            if (confirm('Are you sure you want to delete this product?')) {
                products.splice(index, 1);
                displayProducts();
            }
        }

        function clearProductForm() {
            document.getElementById('productName').value = '';
            document.getElementById('normalPrice').value = '';
            document.getElementById('specialPrice').value = '';
            document.getElementById('specialStart').value = '';
            document.getElementById('specialEnd').value = '';
            document.getElementById('description').value = '';
            document.getElementById('productFile').value = '';
            document.getElementById('productImagePreview').innerHTML = '';
            currentProductImage = '';
        }

        function generateJSON() {
            if (!logoBase64) {
                alert('‚ö†Ô∏è Please upload a logo image first!');
                return;
            }

            if (products.length === 0) {
                alert('‚ö†Ô∏è Please add at least one product!');
                return;
            }

            const settings = {
                logo: logoBase64,
                whatsapp: document.getElementById('whatsapp').value || '',
                instagram: document.getElementById('instagram').value || ''
            };

            const settingsJSON = JSON.stringify(settings, null, 2);
            const productsJSON = JSON.stringify({ products: products }, null, 2);

            document.getElementById('settingsJSON').textContent = settingsJSON;
            document.getElementById('productsJSON').textContent = productsJSON;
            document.getElementById('outputSection').style.display = 'block';

            // Scroll to output
            document.getElementById('outputSection').scrollIntoView({ behavior: 'smooth' });
        }

        function copyToClipboard(elementId) {
            const text = document.getElementById(elementId).textContent;
            navigator.clipboard.writeText(text).then(() => {
                alert('‚úÖ Copied to clipboard!');
            }).catch(err => {
                alert('‚ùå Failed to copy. Please select and copy manually.');
            });
        }

        // Drag and drop support
        document.addEventListener('DOMContentLoaded', function() {
            const uploadAreas = document.querySelectorAll('.upload-area');
            
            uploadAreas.forEach(area => {
                area.addEventListener('dragover', function(e) {
                    e.preventDefault();
                    this.classList.add('dragover');
                });
                
                area.addEventListener('dragleave', function() {
                    this.classList.remove('dragover');
                });
                
                area.addEventListener('drop', function(e) {
                    e.preventDefault();
                    this.classList.remove('dragover');
                    
                    const files = e.dataTransfer.files;
                    if (files.length > 0) {
                        const input = this.querySelector('input[type="file"]');
                        input.files = files;
                        input.dispatchEvent(new Event('change'));
                    }
                });
            });
        });

        // Initialize
        displayProducts();
    </script>
</body>
</html>
