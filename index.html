<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Loom Lyric üß∂</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;500;700&display=swap" rel="stylesheet">

<style>
body{
  font-family:'Poppins',sans-serif;
  background:#001f4d;
  color:#fff;
  margin:0;
  padding:20px;
}
h1,h2{text-align:center;}
.tagline{text-align:center;color:#aad4ff;margin-bottom:30px;}
.products{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(250px,1fr));
  gap:20px;
  max-width:1200px;
  margin:0 auto;
}
.card{
  background:#fff;
  color:#000;
  border-radius:15px;
  padding:15px;
  box-shadow:0 5px 15px rgba(0,0,0,0.2);
  transition:transform 0.3s;
}
.card:hover{
  transform:translateY(-5px);
}
.card img{
  width:100%;
  height:250px;
  object-fit:cover;
  border-radius:12px;
}
.price{font-weight:bold;color:#001f4d;font-size:18px;}
.oldprice{
  text-decoration:line-through;
  color:#555;
  font-size:14px;
}
.whatsapp{
  display:block;
  background:#25D366;
  color:#fff;
  padding:10px;
  text-align:center;
  border-radius:8px;
  text-decoration:none;
  margin-top:10px;
  transition:background 0.3s;
}
.whatsapp:hover{
  background:#20bd5a;
}
.instagram{
  display:block;
  background:#C13584;
  color:#fff;
  padding:10px;
  text-align:center;
  border-radius:8px;
  text-decoration:none;
  margin-top:10px;
  transition:background 0.3s;
}
.instagram:hover{
  background:#a82d72;
}
.admin{
  background:#00264d;
  margin-top:40px;
  padding:20px;
  border-radius:15px;
  display:none;
  max-width:800px;
  margin-left:auto;
  margin-right:auto;
}
input,textarea,button{
  width:100%;
  padding:10px;
  margin:6px 0;
  border-radius:8px;
  border:1px solid #ccc;
  box-sizing:border-box;
}
input[type=file]{border:none;}
button{
  background:#aad4ff;
  color:#001f4d;
  border:none;
  cursor:pointer;
  font-weight:bold;
  transition:background 0.3s;
}
button:hover{
  background:#88c2ff;
}
.manage{
  background:#003366;
  padding:15px;
  margin:8px 0;
  border-radius:8px;
}
.manage button{
  width:48%;
  display:inline-block;
  margin:5px 1%;
}
.footer{
  text-align:center;
  margin-top:40px;
  font-size:13px;
  color:#aad4ff;
  cursor:pointer;
  text-decoration:underline;
}
.footer:hover{
  color:#88c2ff;
}
label{
  font-size:13px;
  color:#aad4ff;
  display:block;
  margin-top:10px;
}
#logoPreview{
  display:block;
  width:120px;
  height:120px;
  margin:20px auto;
  object-fit:cover;
  border:3px solid #aad4ff;
  border-radius:50%;
  box-shadow:0 4px 10px rgba(0,0,0,0.3);
}
#editModal{
  background:#001f4d;
  padding:20px;
  border-radius:10px;
  margin-top:20px;
  border:2px solid #aad4ff;
}
#editImagePreview{
  width:150px;
  height:150px;
  object-fit:cover;
  margin:10px auto;
  border-radius:8px;
  display:none;
  border:2px solid #aad4ff;
}
.delete-btn{
  background:#ff4444 !important;
}
.delete-btn:hover{
  background:#cc0000 !important;
}
.cancel-btn{
  background:#666 !important;
}
.cancel-btn:hover{
  background:#444 !important;
}
</style>
</head>

<body>

<!-- LOGO -->
<img id="logoPreview" src="" alt="Logo">

<h1>Loom Lyric üß∂</h1>
<p class="tagline">Stitching melody in every loop</p>

<h2>Our Handmade Products</h2>
<div class="products" id="products"></div>

<!-- LOGIN -->
<div class="admin" id="loginBox">
  <h2>Admin Login</h2>
  <input id="username" placeholder="Username">
  <input id="password" type="password" placeholder="Password">
  <button onclick="login()">Login</button>
</div>

<!-- ADMIN PANEL -->
<div class="admin" id="adminPanel">
  <h2>Admin Dashboard</h2>

  <!-- Logo Upload -->
  <label>Upload / Change Logo</label>
  <input type="file" id="logo" accept="image/*">
  <button onclick="uploadLogo()">Update Logo</button>

  <!-- WhatsApp number update -->
  <label>WhatsApp Number</label>
  <input id="whatsappNumber" placeholder="Enter number with country code (e.g., 919876543210)">
  <button onclick="updateWhatsApp()">Update WhatsApp Number</button>

  <!-- Instagram ID update -->
  <label>Instagram ID</label>
  <input id="instagramInput" placeholder="Enter Instagram ID">
  <button onclick="updateInstagram()">Update Instagram ID</button>

  <hr style="margin:20px 0; border-color:#aad4ff;">

  <h3>Add New Product</h3>
  <label>Product Name</label>
  <input id="name" placeholder="Product Name">
  
  <label>Normal Price</label>
  <input id="price" placeholder="Normal Price" type="number">
  
  <label>Special Price (optional)</label>
  <input id="specialPrice" placeholder="Special Price (optional)" type="number">
  
  <label>Special Price Start</label>
  <input type="date" id="startDate">
  
  <label>Special Price End</label>
  <input type="date" id="endDate">

  <label>Description</label>
  <textarea id="desc" placeholder="Description" rows="3"></textarea>
  
  <label>Product Image</label>
  <input type="file" id="image" accept="image/*">
  
  <button onclick="addProduct()">Add Product</button>
  <button onclick="logout()" class="cancel-btn">Logout</button>

  <hr style="margin:20px 0; border-color:#aad4ff;">

  <h3>Manage Products</h3>
  <div id="manage"></div>
  
  <!-- Edit Product Modal -->
  <div id="editModal" style="display:none;">
    <h3>Edit Product</h3>
    <label>Product Name</label>
    <input id="editName" placeholder="Product Name">
    
    <label>Normal Price</label>
    <input id="editPrice" placeholder="Normal Price" type="number">
    
    <label>Special Price (optional)</label>
    <input id="editSpecialPrice" placeholder="Special Price" type="number">
    
    <label>Special Price Start</label>
    <input type="date" id="editStartDate">
    
    <label>Special Price End</label>
    <input type="date" id="editEndDate">
    
    <label>Description</label>
    <textarea id="editDesc" placeholder="Description" rows="3"></textarea>
    
    <label>Change Image (optional - leave empty to keep current)</label>
    <input type="file" id="editImage" accept="image/*">
    
    <img id="editImagePreview">
    
    <button onclick="saveEdit()">Save Changes</button>
    <button onclick="cancelEdit()" class="cancel-btn">Cancel</button>
  </div>
</div>

<div class="footer" onclick="toggleLogin()">Admin Access</div>

<script>
/* ===== LOGIN CREDENTIALS ===== */
const USERNAME = "Harshali";
const PASSWORD = "Harshali@123";

/* ===== ELEMENTS ===== */
const productsDiv = document.getElementById("products");
const manageDiv = document.getElementById("manage");
const adminPanel = document.getElementById("adminPanel");
const loginBox = document.getElementById("loginBox");
const whatsappInput = document.getElementById("whatsappNumber");

/* ===== INITIAL SAMPLE PRODUCTS ===== */
const initialProducts = [
  {
    name: "Handmade Crochet Bag",
    price: "450",
    desc: "Beautiful handcrafted crochet bag, perfect for daily use",
    image: "https://images.unsplash.com/photo-1590874103328-eac38a683ce7?w=400&h=400&fit=crop"
  },
  {
    name: "Crochet Tote Bag",
    price: "500",
    desc: "Stylish crochet tote bag with sturdy handles",
    image: "https://images.unsplash.com/photo-1594633312681-425c7b97ccd1?w=400&h=400&fit=crop"
  },
  {
    name: "Mini Crochet Purse",
    price: "350",
    desc: "Cute mini purse perfect for essentials",
    image: "https://images.unsplash.com/photo-1566150905458-1bf1fc113f0d?w=400&h=400&fit=crop"
  },
  {
    name: "Crochet Shoulder Bag",
    price: "550",
    desc: "Elegant shoulder bag with adjustable strap",
    image: "https://images.unsplash.com/photo-1564422170194-896b89110ef8?w=400&h=400&fit=crop"
  },
  {
    name: "Boho Crochet Bag",
    price: "600",
    desc: "Bohemian style crochet bag with fringe details",
    image: "https://images.unsplash.com/photo-1548036328-c9fa89d128fa?w=400&h=400&fit=crop"
  },
  {
    name: "Crochet Clutch",
    price: "400",
    desc: "Handmade crochet clutch for special occasions",
    image: "https://images.unsplash.com/photo-1566150905458-1bf1fc113f0d?w=400&h=400&fit=crop&q=80"
  }
];

/* ===== DATA STORAGE ===== */
let products = JSON.parse(localStorage.getItem("loomProducts")) || [];
let logoSrc = localStorage.getItem("loomLogo") || "";
let whatsappNumber = localStorage.getItem("whatsappNumber") || "919876543210";
let instagramID = localStorage.getItem("instagramID") || "loom__lyric";
let editingIndex = -1;

// Initialize with sample products if empty
if(products.length === 0){
  products = initialProducts;
  save();
}

/* ===== LOGO FUNCTIONS ===== */
function renderLogo(){
  const preview = document.getElementById("logoPreview");
  if(logoSrc){
    preview.src = logoSrc;
    preview.style.display = "block";
  } else {
    preview.style.display = "none";
  }
}
renderLogo();

function uploadLogo(){
  const file = document.getElementById("logo").files[0];
  if(!file){ alert("Please select a logo image"); return; }
  const reader = new FileReader();
  reader.onload = function(){
    logoSrc = reader.result;
    localStorage.setItem("loomLogo", logoSrc);
    renderLogo();
    alert("Logo updated successfully!");
    document.getElementById("logo").value = "";
  };
  reader.readAsDataURL(file);
}

/* ===== WHATSAPP UPDATE ===== */
function updateWhatsApp(){
  const num = whatsappInput.value.trim();
  if(num){
    whatsappNumber = num;
    localStorage.setItem("whatsappNumber", whatsappNumber);
    alert("WhatsApp number updated!");
    whatsappInput.value="";
    render();
  } else {
    alert("Please enter a valid number");
  }
}

/* ===== INSTAGRAM UPDATE ===== */
function updateInstagram(){
  const id = document.getElementById("instagramInput").value.trim();
  if(id){
    instagramID = id;
    localStorage.setItem("instagramID", instagramID);
    alert("Instagram ID updated!");
    document.getElementById("instagramInput").value = "";
    render();
  } else {
    alert("Please enter a valid Instagram ID");
  }
}

/* ===== HELPER FUNCTIONS ===== */
function save(){
  localStorage.setItem("loomProducts", JSON.stringify(products));
}

function currentPrice(p){
  const now = new Date().toISOString().split("T")[0];
  if(p.specialPrice && p.startDate && p.endDate){
    if(now >= p.startDate && now <= p.endDate){
      return { price: p.specialPrice, old: p.price };
    }
  }
  return { price: p.price };
}

/* ===== RENDER PRODUCTS ===== */
function render(){
  let userHTML="", adminHTML="";
  if(products.length===0){ 
    userHTML="<p style='text-align:center; grid-column: 1/-1;'>No products yet. Login to admin to add products.</p>"; 
  }

  products.forEach((p,i)=>{
    const cp = currentPrice(p);

    userHTML+=`
      <div class="card">
        <img src="${p.image}" alt="${p.name}">
        <h3>${p.name}</h3>
        ${ cp.old ? `<p class="oldprice">‚Çπ${cp.old}</p><p class="price">‚Çπ${cp.price}</p>` : `<p class="price">‚Çπ${cp.price}</p>` }
        <p>${p.desc || ""}</p>
        <a class="whatsapp"
          href="https://wa.me/${whatsappNumber}?text=Hi! I want to order ${encodeURIComponent(p.name)}">
          Order on WhatsApp
        </a>
        <a class="instagram"
          href="https://www.instagram.com/${instagramID}" target="_blank">
          Contact on Instagram
        </a>
      </div>`;

    adminHTML+=`
      <div class="manage">
        <b>${p.name}</b> - ‚Çπ${p.price}<br>
        <small style="color:#aad4ff;">${p.desc ? p.desc.substring(0,50) + '...' : 'No description'}</small><br>
        <button onclick="editProduct(${i})">‚úèÔ∏è Edit</button>
        <button onclick="deleteProduct(${i})" class="delete-btn">üóëÔ∏è Delete</button>
      </div>`;
  });

  productsDiv.innerHTML=userHTML;
  manageDiv.innerHTML=adminHTML;
}

/* ===== ADMIN LOGIN/LOGOUT ===== */
function toggleLogin(){ 
  loginBox.style.display = loginBox.style.display==="block"?"none":"block"; 
}

function login(){
  if(username.value===USERNAME && password.value===PASSWORD){
    loginBox.style.display="none";
    adminPanel.style.display="block";
    username.value = "";
    password.value = "";
  }else{ 
    alert("Wrong username or password!"); 
  }
}

function logout(){ 
  adminPanel.style.display="none";
  document.getElementById("editModal").style.display="none";
}

/* ===== ADD NEW PRODUCT ===== */
function addProduct(){
  const nameVal = document.getElementById("name").value.trim();
  const priceVal = document.getElementById("price").value.trim();
  const file = document.getElementById("image").files[0];
  
  if(!nameVal || !priceVal){ 
    alert("Please enter product name and price"); 
    return; 
  }
  if(!file){ 
    alert("Please select a product image"); 
    return; 
  }

  const reader = new FileReader();
  reader.onload = function(){
    products.push({
      name: nameVal,
      price: priceVal,
      specialPrice: document.getElementById("specialPrice").value.trim(),
      startDate: document.getElementById("startDate").value,
      endDate: document.getElementById("endDate").value,
      desc: document.getElementById("desc").value.trim(),
      image: reader.result
    });
    save();
    render();
    
    // Clear form
    document.getElementById("name").value = "";
    document.getElementById("price").value = "";
    document.getElementById("specialPrice").value = "";
    document.getElementById("startDate").value = "";
    document.getElementById("endDate").value = "";
    document.getElementById("desc").value = "";
    document.getElementById("image").value = "";
    
    alert("Product added successfully!");
  };
  reader.readAsDataURL(file);
}

/* ===== DELETE PRODUCT ===== */
function deleteProduct(i){
  if(confirm("Are you sure you want to delete this product?")){
    products.splice(i,1);
    save();
    render();
    alert("Product deleted successfully!");
  }
}

/* ===== EDIT PRODUCT ===== */
function editProduct(i){
  editingIndex = i;
  const p = products[i];
  
  // Fill the edit form with current data
  document.getElementById("editName").value = p.name;
  document.getElementById("editPrice").value = p.price;
  document.getElementById("editSpecialPrice").value = p.specialPrice ||
